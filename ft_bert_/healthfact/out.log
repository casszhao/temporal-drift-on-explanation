2022-05-14 00:54:29 INFO     Running on cuda : True
2022-05-14 00:54:29 INFO     config  : 
 ----------------------
2022-05-14 00:54:29 INFO     dataset : healthfact
2022-05-14 00:54:29 INFO     data_dir : /jmain02/home/J2AD003/txk58/zxz22-txk58/extract_rationales/extract_rationales/datasets/healthfact/data/
2022-05-14 00:54:29 INFO     model_dir : /jmain02/home/J2AD003/txk58/zxz22-txk58/extract_rationales/extract_rationales/models/healthfact/
2022-05-14 00:54:29 INFO     seed : 5
2022-05-14 00:54:29 INFO     evaluate_models : False
2022-05-14 00:54:29 INFO     inherently_faithful : None
2022-05-14 00:54:29 INFO     use_tasc : False
2022-05-14 00:54:29 INFO     importance_metric : None
2022-05-14 00:54:29 INFO     rationale_length : 0.2
2022-05-14 00:54:29 INFO     batch_size : 8
2022-05-14 00:54:29 INFO     lr_bert : 1e-05
2022-05-14 00:54:29 INFO     lr_classifier : 1e-05
2022-05-14 00:54:29 INFO     model : scibert_scivocab_uncased
2022-05-14 00:54:29 INFO     ood_dataset_1 : healthfact_ood1
2022-05-14 00:54:29 INFO     ood_dataset_2 : healthfact_ood2
2022-05-14 00:54:29 INFO     epochs : 5
2022-05-14 00:54:29 INFO     model_abbreviation : scibert
2022-05-14 00:54:29 INFO     evaluation_dir : None
2022-05-14 00:54:29 INFO     extracted_rationale_dir : None
2022-05-14 00:54:29 INFO     query : False
2022-05-14 00:54:29 INFO     stage_of_proj : train
2022-05-14 00:54:29 INFO     ood_rat_1 : 0.2
2022-05-14 00:54:29 INFO     ood_rat_2 : 0.2
2022-05-14 00:54:29 INFO     embed_model : None
2022-05-14 00:54:29 INFO     
 ----------------------
2022-05-14 00:55:36 INFO     Finetune BERT for: healthfact
2022-05-14 00:55:36 INFO     batch size: 8
2022-05-14 00:55:36 INFO      -------------------- learning rate: 5e-4
2022-05-14 00:56:04 INFO     ***************************************
2022-05-14 00:56:04 INFO     Training on seed 5
2022-05-14 00:56:04 INFO     *saving checkpoint every 246 iterations
2022-05-14 00:56:04 INFO     +++++++++++++ epochs:  5
2022-05-14 00:58:56 INFO     *** epoch - 1 | train loss - 9.78 | dev f1 - 0.139 | dev loss - 9.54
2022-05-14 01:01:43 INFO     *** epoch - 2 | train loss - 9.55 | dev f1 - 0.138 | dev loss - 9.46
2022-05-14 01:04:28 INFO     *** epoch - 3 | train loss - 9.48 | dev f1 - 0.139 | dev loss - 9.47
2022-05-14 01:07:17 INFO     *** epoch - 4 | train loss - 9.47 | dev f1 - 0.139 | dev loss - 9.46
2022-05-14 01:10:01 INFO     *** epoch - 5 | train loss - 9.44 | dev f1 - 0.139 | dev loss - 9.43
2022-05-14 01:10:02 INFO      -------------------- learning rate: 1e-5
2022-05-14 01:10:04 INFO     ***************************************
2022-05-14 01:10:04 INFO     Training on seed 5
2022-05-14 01:10:04 INFO     *saving checkpoint every 246 iterations
2022-05-14 01:10:04 INFO     +++++++++++++ epochs:  5
2022-05-14 01:12:55 INFO     *** epoch - 1 | train loss - 10.32 | dev f1 - 0.139 | dev loss - 9.71
2022-05-14 01:15:43 INFO     *** epoch - 2 | train loss - 9.85 | dev f1 - 0.138 | dev loss - 9.58
2022-05-14 01:18:33 INFO     *** epoch - 3 | train loss - 9.7 | dev f1 - 0.139 | dev loss - 9.46
2022-05-14 01:21:19 INFO     *** epoch - 4 | train loss - 9.61 | dev f1 - 0.139 | dev loss - 9.67
2022-05-14 01:24:01 INFO     *** epoch - 5 | train loss - 9.47 | dev f1 - 0.138 | dev loss - 9.47
2022-05-14 01:24:05 INFO     ***************************************
2022-05-14 01:24:05 INFO     Training on seed 5
2022-05-14 01:24:05 INFO     *saving checkpoint every 246 iterations
2022-05-14 01:24:05 INFO     +++++++++++++ epochs:  5
2022-05-14 01:26:56 INFO     *** epoch - 1 | train loss - 8.02 | dev f1 - 0.418 | dev loss - 7.23
2022-05-14 01:29:41 INFO     *** epoch - 2 | train loss - 6.01 | dev f1 - 0.45 | dev loss - 7.63
2022-05-14 01:32:26 INFO     *** epoch - 3 | train loss - 4.27 | dev f1 - 0.502 | dev loss - 9.75
2022-05-14 01:35:11 INFO     *** epoch - 4 | train loss - 2.89 | dev f1 - 0.516 | dev loss - 11.32
2022-05-14 01:37:58 INFO     *** epoch - 5 | train loss - 2.11 | dev f1 - 0.516 | dev loss - 13.09
2022-05-14 01:37:59 INFO      -------------------- learning rate: 1e-5
2022-05-14 01:38:02 INFO     ***************************************
2022-05-14 01:38:02 INFO     Training on seed 5
2022-05-14 01:38:02 INFO     *saving checkpoint every 246 iterations
2022-05-14 01:38:02 INFO     +++++++++++++ epochs:  5
2022-05-14 01:40:52 INFO     *** epoch - 1 | train loss - 9.61 | dev f1 - 0.139 | dev loss - 9.58
2022-05-14 01:43:34 INFO     *** epoch - 2 | train loss - 9.5 | dev f1 - 0.138 | dev loss - 9.43
2022-05-14 01:46:16 INFO     *** epoch - 3 | train loss - 9.46 | dev f1 - 0.139 | dev loss - 9.45
2022-05-14 01:49:01 INFO     *** epoch - 4 | train loss - 9.46 | dev f1 - 0.138 | dev loss - 9.46
2022-05-14 01:51:43 INFO     *** epoch - 5 | train loss - 9.44 | dev f1 - 0.139 | dev loss - 9.43
2022-05-14 01:51:44 INFO      -------------------- learning rate: 5e-5
2022-05-14 01:51:46 INFO     ***************************************
2022-05-14 01:51:46 INFO     Training on seed 5
2022-05-14 01:51:46 INFO     *saving checkpoint every 246 iterations
2022-05-14 01:51:46 INFO     +++++++++++++ epochs:  5
2022-05-14 01:54:41 INFO     *** epoch - 1 | train loss - 8.58 | dev f1 - 0.395 | dev loss - 8.05
2022-05-14 01:57:29 INFO     *** epoch - 2 | train loss - 7.58 | dev f1 - 0.393 | dev loss - 7.86
2022-05-14 02:00:15 INFO     *** epoch - 3 | train loss - 7.23 | dev f1 - 0.408 | dev loss - 7.78
2022-05-14 02:03:00 INFO     *** epoch - 4 | train loss - 7.01 | dev f1 - 0.412 | dev loss - 7.81
2022-05-14 02:05:43 INFO     *** epoch - 5 | train loss - 6.97 | dev f1 - 0.408 | dev loss - 7.78
2022-05-14 02:05:45 INFO      -------------------- learning rate: 1e-6
2022-05-14 02:05:47 INFO     ***************************************
2022-05-14 02:05:47 INFO     Training on seed 5
2022-05-14 02:05:47 INFO     *saving checkpoint every 246 iterations
2022-05-14 02:05:47 INFO     +++++++++++++ epochs:  5
2022-05-14 02:08:35 INFO     *** epoch - 1 | train loss - 8.06 | dev f1 - 0.432 | dev loss - 7.33
2022-05-14 02:11:20 INFO     *** epoch - 2 | train loss - 6.43 | dev f1 - 0.439 | dev loss - 7.63
2022-05-14 02:14:04 INFO     *** epoch - 3 | train loss - 5.34 | dev f1 - 0.462 | dev loss - 8.06
2022-05-14 02:16:47 INFO     *** epoch - 4 | train loss - 4.53 | dev f1 - 0.495 | dev loss - 8.61
2022-05-14 02:19:31 INFO     *** epoch - 5 | train loss - 4.04 | dev f1 - 0.509 | dev loss - 9.13
2022-05-14 02:20:08 INFO     Finetune BERT for: healthfact
2022-05-14 02:20:08 INFO     batch size: 16
2022-05-14 02:20:08 INFO      -------------------- learning rate: 5e-4
2022-05-14 02:20:11 INFO     ***************************************
2022-05-14 02:20:11 INFO     Training on seed 5
2022-05-14 02:20:11 INFO     *saving checkpoint every 123 iterations
2022-05-14 02:20:11 INFO     +++++++++++++ epochs:  5
2022-05-14 02:22:49 INFO     *** epoch - 1 | train loss - 19.52 | dev f1 - 0.139 | dev loss - 18.9
2022-05-14 02:25:21 INFO     *** epoch - 2 | train loss - 19.02 | dev f1 - 0.138 | dev loss - 18.93
2022-05-14 02:27:51 INFO     *** epoch - 3 | train loss - 18.94 | dev f1 - 0.138 | dev loss - 18.96
2022-05-14 02:30:24 INFO     *** epoch - 4 | train loss - 18.93 | dev f1 - 0.138 | dev loss - 18.87
2022-05-14 02:32:56 INFO     *** epoch - 5 | train loss - 18.87 | dev f1 - 0.139 | dev loss - 18.9
2022-05-14 02:32:57 INFO      -------------------- learning rate: 1e-5
2022-05-14 02:32:59 INFO     ***************************************
2022-05-14 02:32:59 INFO     Training on seed 5
2022-05-14 02:32:59 INFO     *saving checkpoint every 123 iterations
2022-05-14 02:32:59 INFO     +++++++++++++ epochs:  5
2022-05-14 02:35:32 INFO     *** epoch - 1 | train loss - 20.52 | dev f1 - 0.138 | dev loss - 19.43
2022-05-14 02:38:03 INFO     *** epoch - 2 | train loss - 19.71 | dev f1 - 0.138 | dev loss - 19.45
2022-05-14 02:40:34 INFO     *** epoch - 3 | train loss - 19.21 | dev f1 - 0.138 | dev loss - 19.02
2022-05-14 02:43:05 INFO     *** epoch - 4 | train loss - 19.09 | dev f1 - 0.139 | dev loss - 19.03
2022-05-14 02:45:38 INFO     *** epoch - 5 | train loss - 18.93 | dev f1 - 0.139 | dev loss - 18.92
2022-05-14 02:45:40 INFO     ***************************************
2022-05-14 02:45:40 INFO     Training on seed 5
2022-05-14 02:45:40 INFO     *saving checkpoint every 123 iterations
2022-05-14 02:45:40 INFO     +++++++++++++ epochs:  5
2022-05-14 02:48:18 INFO     *** epoch - 1 | train loss - 16.05 | dev f1 - 0.454 | dev loss - 14.05
2022-05-14 02:50:51 INFO     *** epoch - 2 | train loss - 11.86 | dev f1 - 0.454 | dev loss - 14.74
2022-05-14 02:53:22 INFO     *** epoch - 3 | train loss - 8.53 | dev f1 - 0.499 | dev loss - 17.06
2022-05-14 02:55:54 INFO     *** epoch - 4 | train loss - 6.09 | dev f1 - 0.497 | dev loss - 19.92
2022-05-14 02:58:25 INFO     *** epoch - 5 | train loss - 4.59 | dev f1 - 0.508 | dev loss - 22.11
2022-05-14 02:58:25 INFO      -------------------- learning rate: 1e-5
2022-05-14 02:58:27 INFO     ***************************************
2022-05-14 02:58:27 INFO     Training on seed 5
2022-05-14 02:58:27 INFO     *saving checkpoint every 123 iterations
2022-05-14 02:58:27 INFO     +++++++++++++ epochs:  5
2022-05-14 03:01:05 INFO     *** epoch - 1 | train loss - 19.34 | dev f1 - 0.139 | dev loss - 18.9
2022-05-14 03:03:36 INFO     *** epoch - 2 | train loss - 18.97 | dev f1 - 0.138 | dev loss - 18.9
2022-05-14 03:06:11 INFO     *** epoch - 3 | train loss - 18.91 | dev f1 - 0.138 | dev loss - 18.93
2022-05-14 03:08:45 INFO     *** epoch - 4 | train loss - 18.91 | dev f1 - 0.138 | dev loss - 18.87
2022-05-14 03:11:17 INFO     *** epoch - 5 | train loss - 18.86 | dev f1 - 0.139 | dev loss - 18.9
2022-05-14 03:11:18 INFO      -------------------- learning rate: 5e-5
2022-05-14 03:11:20 INFO     ***************************************
2022-05-14 03:11:20 INFO     Training on seed 5
2022-05-14 03:11:20 INFO     *saving checkpoint every 123 iterations
2022-05-14 03:11:20 INFO     +++++++++++++ epochs:  5
2022-05-14 03:13:57 INFO     *** epoch - 1 | train loss - 17.43 | dev f1 - 0.366 | dev loss - 16.27
2022-05-14 03:16:32 INFO     *** epoch - 2 | train loss - 15.41 | dev f1 - 0.391 | dev loss - 15.92
2022-05-14 03:19:06 INFO     *** epoch - 3 | train loss - 14.77 | dev f1 - 0.403 | dev loss - 15.68
2022-05-14 03:21:39 INFO     *** epoch - 4 | train loss - 14.37 | dev f1 - 0.404 | dev loss - 15.67
2022-05-14 03:24:12 INFO     *** epoch - 5 | train loss - 14.21 | dev f1 - 0.406 | dev loss - 15.63
2022-05-14 03:24:12 INFO      -------------------- learning rate: 1e-6
2022-05-14 03:24:14 INFO     ***************************************
2022-05-14 03:24:14 INFO     Training on seed 5
2022-05-14 03:24:14 INFO     *saving checkpoint every 123 iterations
2022-05-14 03:24:14 INFO     +++++++++++++ epochs:  5
2022-05-14 03:26:57 INFO     *** epoch - 1 | train loss - 16.31 | dev f1 - 0.44 | dev loss - 14.78
2022-05-14 03:29:34 INFO     *** epoch - 2 | train loss - 13.16 | dev f1 - 0.445 | dev loss - 15.04
2022-05-14 03:32:05 INFO     *** epoch - 3 | train loss - 11.2 | dev f1 - 0.453 | dev loss - 15.61
2022-05-14 03:34:37 INFO     *** epoch - 4 | train loss - 9.78 | dev f1 - 0.47 | dev loss - 16.01
2022-05-14 03:37:08 INFO     *** epoch - 5 | train loss - 8.82 | dev f1 - 0.471 | dev loss - 16.5
